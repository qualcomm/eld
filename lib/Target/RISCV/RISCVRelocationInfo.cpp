//===- RISCVRelocationInfo.cpp---------------------------------------------===//
// Part of the eld Project, under the BSD License
// See https://github.com/qualcomm/eld/LICENSE.txt for license information.
// SPDX-License-Identifier: BSD-3-Clause
//===----------------------------------------------------------------------===//
#ifndef RISCV_RELOCATION_INFO_H
#define RISCV_RELOCATION_INFO_H

#include "RISCVLLVMExtern.h"
#include "RISCVRelocationInternal.h"
#include "llvm/BinaryFormat/ELF.h"
#include <unordered_map>

namespace eld {

namespace {

const RelocationInfo RISCVUnknownReloc = {
    "INVALID_RELOC", ~0u, EncTy_None, 0, 0, false, false, false, 0};

typedef std::unordered_map<int32_t, RelocationInfo> RISCVRelocationMap;

RISCVRelocationMap RISCVRelocs = {
    /* Standard Relocations */
    {llvm::ELF::R_RISCV_NONE,
     {/*.Name = */ "R_RISCV_NONE",
      /*.Type = */ llvm::ELF::R_RISCV_NONE,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 0}},
    {llvm::ELF::R_RISCV_32,
     {/*.Name = */ "R_RISCV_32",
      /*.Type = */ llvm::ELF::R_RISCV_32,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_64,
     {/*.Name = */ "R_RISCV_64",
      /*.Type = */ llvm::ELF::R_RISCV_64,
      /*EncodingType = */ EncTy_64,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 64}},
    {llvm::ELF::R_RISCV_RELATIVE,
     {/*.Name = */ "R_RISCV_RELATIVE",
      /*.Type = */ llvm::ELF::R_RISCV_RELATIVE,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_COPY,
     {/*.Name = */ "R_RISCV_COPY",
      /*.Type = */ llvm::ELF::R_RISCV_COPY,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_JUMP_SLOT,
     {/*.Name = */ "R_RISCV_JUMP_SLOT",
      /*.Type = */ llvm::ELF::R_RISCV_JUMP_SLOT,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TLS_DTPMOD32,
     {/*.Name = */ "R_RISCV_TLS_DTPMOD32",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_DTPMOD32,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TLS_DTPMOD64,
     {/*.Name = */ "R_RISCV_TLS_DTPMOD64",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_DTPMOD64,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 64}},
    {llvm::ELF::R_RISCV_TLS_DTPREL32,
     {/*.Name = */ "R_RISCV_TLS_DTPREL32",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_DTPREL32,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TLS_DTPREL64,
     {/*.Name = */ "R_RISCV_TLS_DTPREL64",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_DTPREL64,
      /*EncodingType = */ EncTy_64,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 64}},
    {llvm::ELF::R_RISCV_TLS_TPREL32,
     {/*.Name = */ "R_RISCV_TLS_TPREL32",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_TPREL32,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TLS_TPREL64,
     {/*.Name = */ "R_RISCV_TLS_TPREL64",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_TPREL64,
      /*EncodingType = */ EncTy_64,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 64}},
    {llvm::ELF::R_RISCV_BRANCH,
     {/*.Name = */ "R_RISCV_BRANCH",
      /*.Type = */ llvm::ELF::R_RISCV_BRANCH,
      /*EncodingType = */ EncTy_SB,
      /*.Alignment = */ 2,
      /*.shift = */ 1,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ true,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_JAL,
     {/*.Name = */ "R_RISCV_JAL",
      /*.Type = */ llvm::ELF::R_RISCV_JAL,
      /*EncodingType = */ EncTy_UJ,
      /*.Alignment = */ 2,
      /*.shift = */ 20,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ true,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_CALL,
     {/*.Name = */ "R_RISCV_CALL",
      /*.Type = */ llvm::ELF::R_RISCV_CALL,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 2,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_CALL_PLT,
     {/*.Name = */ "R_RISCV_CALL_PLT",
      /*.Type = */ llvm::ELF::R_RISCV_CALL_PLT,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 2,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_GOT_HI20,
     {/*.Name = */ "R_RISCV_GOT_HI20",
      /*.Type = */ llvm::ELF::R_RISCV_GOT_HI20,
      /*EncodingType = */ EncTy_U_HI20,
      /*.Alignment = */ 0,
      /*.shift = */ 20,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TLS_GOT_HI20,
     {/*.Name = */ "R_RISCV_TLS_GOT_HI20",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_GOT_HI20,
      /*EncodingType = */ EncTy_U_HI20,
      /*.Alignment = */ 0,
      /*.shift = */ 20,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TLS_GD_HI20,
     {/*.Name = */ "R_RISCV_TLS_GD_HI20",
      /*.Type = */ llvm::ELF::R_RISCV_TLS_GD_HI20,
      /*EncodingType = */ EncTy_U_HI20,
      /*.Alignment = */ 0,
      /*.shift = */ 20,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_PCREL_HI20,
     {/*.Name = */ "R_RISCV_PCREL_HI20",
      /*.Type = */ llvm::ELF::R_RISCV_PCREL_HI20,
      /*EncodingType = */ EncTy_U_HI20,
      /*.Alignment = */ 0,
      /*.shift = */ 20,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_PCREL_LO12_I,
     {/*.Name = */ "R_RISCV_PCREL_LO12_I",
      /*.Type = */ llvm::ELF::R_RISCV_PCREL_LO12_I,
      /*EncodingType = */ EncTy_I,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_PCREL_LO12_S,
     {/*.Name = */ "R_RISCV_PCREL_LO12_S",
      /*.Type = */ llvm::ELF::R_RISCV_PCREL_LO12_S,
      /*EncodingType = */ EncTy_S,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_HI20,
     {/*.Name = */ "R_RISCV_HI20",
      /*.Type = */ llvm::ELF::R_RISCV_HI20,
      /*EncodingType = */ EncTy_U_HI20,
      /*.Alignment = */ 0,
      /*.shift = */ 12,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_LO12_I,
     {/*.Name = */ "R_RISCV_LO12_I",
      /*.Type = */ llvm::ELF::R_RISCV_LO12_I,
      /*EncodingType = */ EncTy_I,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_LO12_S,
     {/*.Name = */ "R_RISCV_LO12_S",
      /*.Type = */ llvm::ELF::R_RISCV_LO12_S,
      /*EncodingType = */ EncTy_S,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TPREL_HI20,
     {/*.Name = */ "R_RISCV_TPREL_HI20",
      /*.Type = */ llvm::ELF::R_RISCV_TPREL_HI20,
      /*EncodingType = */ EncTy_U_HI20,
      /*.Alignment = */ 0,
      /*.shift = */ 20,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TPREL_LO12_I,
     {/*.Name = */ "R_RISCV_TPREL_LO12_I",
      /*.Type = */ llvm::ELF::R_RISCV_TPREL_LO12_I,
      /*EncodingType = */ EncTy_I,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TPREL_LO12_S,
     {/*.Name = */ "R_RISCV_TPREL_LO12_S",
      /*.Type = */ llvm::ELF::R_RISCV_TPREL_LO12_S,
      /*EncodingType = */ EncTy_S,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_TPREL_ADD,
     {/*.Name = */ "R_RISCV_TPREL_ADD",
      /*.Type = */ llvm::ELF::R_RISCV_TPREL_ADD,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_ADD8,
     {/*.Name = */ "R_RISCV_ADD8",
      /*.Type = */ llvm::ELF::R_RISCV_ADD8,
      /*EncodingType = */ EncTy_8,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 8}},
    {llvm::ELF::R_RISCV_ADD16,
     {/*.Name = */ "R_RISCV_ADD16",
      /*.Type = */ llvm::ELF::R_RISCV_ADD16,
      /*EncodingType = */ EncTy_16,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 16}},
    {llvm::ELF::R_RISCV_ADD32,
     {/*.Name = */ "R_RISCV_ADD32",
      /*.Type = */ llvm::ELF::R_RISCV_ADD32,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_ADD64,
     {/*.Name = */ "R_RISCV_ADD64",
      /*.Type = */ llvm::ELF::R_RISCV_ADD64,
      /*EncodingType = */ EncTy_64,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 64}},
    {llvm::ELF::R_RISCV_SUB8,
     {/*.Name = */ "R_RISCV_SUB8",
      /*.Type = */ llvm::ELF::R_RISCV_SUB8,
      /*EncodingType = */ EncTy_8,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 8}},
    {llvm::ELF::R_RISCV_SUB16,
     {/*.Name = */ "R_RISCV_SUB16",
      /*.Type = */ llvm::ELF::R_RISCV_SUB16,
      /*EncodingType = */ EncTy_16,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 16}},
    {llvm::ELF::R_RISCV_SUB32,
     {/*.Name = */ "R_RISCV_SUB32",
      /*.Type = */ llvm::ELF::R_RISCV_SUB32,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_SUB64,
     {/*.Name = */ "R_RISCV_SUB64",
      /*.Type = */ llvm::ELF::R_RISCV_SUB64,
      /*EncodingType = */ EncTy_64,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 64}},
    {llvm::ELF::R_RISCV_GOT32_PCREL,
     {/*.Name = */ "R_RISCV_GOT32_PCREL",
      /*.Type = */ llvm::ELF::R_RISCV_GOT32_PCREL,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_ALIGN,
     {/*.Name = */ "R_RISCV_ALIGN",
      /*.Type = */ llvm::ELF::R_RISCV_ALIGN,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_RVC_BRANCH,
     {/*.Name = */ "R_RISCV_RVC_BRANCH",
      /*.Type = */ llvm::ELF::R_RISCV_RVC_BRANCH,
      /*EncodingType = */ EncTy_CB,
      /*.Alignment = */ 2,
      /*.shift = */ 8,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ true,
      /*.Signed = */ true,
      /*.Size = */ 16}},
    {llvm::ELF::R_RISCV_RVC_JUMP,
     {/*.Name = */ "R_RISCV_RVC_JUMP",
      /*.Type = */ llvm::ELF::R_RISCV_RVC_JUMP,
      /*EncodingType = */ EncTy_CJ,
      /*.Alignment = */ 2,
      /*.shift = */ 12,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ true,
      /*.Signed = */ true,
      /*.Size = */ 16}},
    {llvm::ELF::R_RISCV_RELAX,
     {/*.Name = */ "R_RISCV_RELAX",
      /*.Type = */ llvm::ELF::R_RISCV_RELAX,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_SUB6,
     {/*.Name = */ "R_RISCV_SUB6",
      /*.Type = */ llvm::ELF::R_RISCV_SUB6,
      /*EncodingType = */ EncTy_6,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 8}},
    {llvm::ELF::R_RISCV_SET6,
     {/*.Name = */ "R_RISCV_SET6",
      /*.Type = */ llvm::ELF::R_RISCV_SET6,
      /*EncodingType = */ EncTy_6,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 8}},
    {llvm::ELF::R_RISCV_SET8,
     {/*.Name = */ "R_RISCV_SET8",
      /*.Type = */ llvm::ELF::R_RISCV_SET8,
      /*EncodingType = */ EncTy_8,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 8}},
    {llvm::ELF::R_RISCV_SET16,
     {/*.Name = */ "R_RISCV_SET16",
      /*.Type = */ llvm::ELF::R_RISCV_SET16,
      /*EncodingType = */ EncTy_16,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 16}},
    {llvm::ELF::R_RISCV_SET32,
     {/*.Name = */ "R_RISCV_SET32",
      /*.Type = */ llvm::ELF::R_RISCV_SET32,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},
    {llvm::ELF::R_RISCV_32_PCREL,
     {/*.Name = */ "R_RISCV_32_PCREL",
      /*.Type = */ llvm::ELF::R_RISCV_32_PCREL,
      /*EncodingType = */ EncTy_32,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 32}},

    {llvm::ELF::R_RISCV_VENDOR,
     {/*.Name = */ "R_RISCV_VENDOR",
      /*.Type = */ llvm::ELF::R_RISCV_VENDOR,
      /*EncodingType = */ EncTy_None,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 0}},
    {llvm::ELF::R_RISCV_SET_ULEB128,
     {/*.Name = */ "R_RISCV_SET_ULEB128",
      /*.Type = */ llvm::ELF::R_RISCV_SET_ULEB128,
      /*EncodingType = */ EncTy_LEB128,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 0}}, /* Dont cache */
    {llvm::ELF::R_RISCV_SUB_ULEB128,
     {/*.Name = */ "R_RISCV_SUB_ULEB128",
      /*.Type = */ llvm::ELF::R_RISCV_SUB_ULEB128,
      /*EncodingType = */ EncTy_LEB128,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ false,
      /*.Size = */ 0}}, /* Dont cache */
    /* Internal Relocations for Relaxations */
    {eld::ELF::riscv::internal::R_RISCV_RVC_LUI,
     {/*.Name = */ "R_RISCV_RVC_LUI",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_RVC_LUI,
      /*EncodingType = */ EncTy_CI,
      /*.Alignment = */ 0,
      /*.shift = */ 12,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 16}},
    {eld::ELF::riscv::internal::R_RISCV_GPREL_I,
     {/*.Name = */ "R_RISCV_GPREL_I",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_GPREL_I,
      /*EncodingType = */ EncTy_I,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {eld::ELF::riscv::internal::R_RISCV_GPREL_S,
     {/*.Name = */ "R_RISCV_GPREL_S",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_GPREL_S,
      /*EncodingType = */ EncTy_S,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {eld::ELF::riscv::internal::R_RISCV_TPREL_I,
     {/*.Name = */ "R_RISCV_TPREL_I",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_TPREL_I,
      /*EncodingType = */ EncTy_I,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {eld::ELF::riscv::internal::R_RISCV_TPREL_S,
     {/*.Name = */ "R_RISCV_TPREL_S",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_TPREL_S,
      /*EncodingType = */ EncTy_S,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ false,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    /* Internal Relocations: Vendor */
    {eld::ELF::riscv::internal::R_RISCV_QC_ABS20_U,
     {/*.Name = */ "R_RISCV_QC_ABS20_U",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_QC_ABS20_U,
      /*EncodingType = */ EncTy_U_ABS20,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 32}},
    {eld::ELF::riscv::internal::R_RISCV_QC_E_BRANCH,
     {/*.Name = */ "R_RISCV_QC_E_BRANCH",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_QC_E_BRANCH,
      /*EncodingType = */ EncTy_QC_EB,
      /*.Alignment = */ 2,
      /*.shift = */ 1,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ true,
      /*.Signed = */ true,
      /*.Size = */ 48}},
    {eld::ELF::riscv::internal::R_RISCV_QC_E_32,
     {/*.Name = */ "R_RISCV_QC_E_32",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_QC_E_32,
      /*EncodingType = */ EncTy_QC_EAI,
      /*.Alignment = */ 0,
      /*.shift = */ 0,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ false,
      /*.Signed = */ true,
      /*.Size = */ 48}},
    {eld::ELF::riscv::internal::R_RISCV_QC_E_JUMP_PLT,
     {/*.Name = */ "R_RISCV_QC_E_JUMP_PLT",
      /*.Type = */ eld::ELF::riscv::internal::R_RISCV_QC_E_JUMP_PLT,
      /*EncodingType = */ EncTy_QC_EJ,
      /*.Alignment = */ 2,
      /*.shift = */ 1,
      /*.VerifyRange = */ true,
      /*.VerifyAlignment = */ true,
      /*.Signed = */ true,
      /*.Size = */ 48}},
};

} // namespace

const RelocationInfo &getRISCVReloc(uint32_t pType) {
  const auto It = RISCVRelocs.find(pType);
  if (It != RISCVRelocs.end())
    return It->second;

  return RISCVUnknownReloc;
}

std::string getRISCVRelocName(uint32_t pType) {
  const auto It = RISCVRelocs.find(pType);
  if (It != RISCVRelocs.end())
    return It->second.Name;

  using namespace eld::ELF::riscv;
  if (internal::FirstNonstandardRelocation <= pType &&
      pType <= internal::LastNonstandardRelocation)
    return "R_RISCV_CUSTOM" + std::to_string(pType);

  return "INVALID_RELOC_" + std::to_string(pType);
}

} // namespace eld

#endif
